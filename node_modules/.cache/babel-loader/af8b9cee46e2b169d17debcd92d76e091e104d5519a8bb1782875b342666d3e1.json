{"ast":null,"code":"import React,{useMemo,useRef}from'react';import html2pdf from'html2pdf.js';/**\n * EntryHistory component\n *\n * Displays a list of past diary entries with optional filtering by year and month.\n * Also provides a button to export the currently displayed history as a PDF.\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function EntryHistory(_ref){let{entries,onFilterChange}=_ref;// reference to the printable container\nconst printRef=useRef(null);// Build sets of years and months present in the entries\nconst years=useMemo(()=>{const set=new Set();entries.forEach(entry=>{const y=entry.date.split('-')[0];set.add(y);});return Array.from(set).sort((a,b)=>b.localeCompare(a));},[entries]);const months=useMemo(()=>{const set=new Set();entries.forEach(entry=>{const m=entry.date.split('-')[1];set.add(m);});return Array.from(set).sort();},[entries]);// Handler for export to PDF\nconst handleExportPdf=()=>{const element=printRef.current;if(!element)return;// Use html2pdf to generate the PDF from the element\nconst opt={margin:[10,10,10,10],filename:'diario-gratitudine.pdf',image:{type:'jpeg',quality:0.98},html2canvas:{scale:2},jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}};html2pdf().set(opt).from(element).save();};return/*#__PURE__*/_jsxs(\"div\",{className:\"my-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-4\",children:\"Storico dei tuoi diari\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-4 mb-4 items-end\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-gray-600\",htmlFor:\"year-filter\",children:\"Anno\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"year-filter\",onChange:e=>onFilterChange(e.target.value,null),className:\"mt-1 block w-32 border-gray-300 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tutti\"}),years.map(year=>/*#__PURE__*/_jsx(\"option\",{value:year,children:year},year))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-gray-600\",htmlFor:\"month-filter\",children:\"Mese\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"month-filter\",onChange:e=>onFilterChange(null,e.target.value),className:\"mt-1 block w-32 border-gray-300 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Tutti\"}),months.map(month=>/*#__PURE__*/_jsx(\"option\",{value:month,children:month},month))]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleExportPdf,className:\"ml-auto bg-primary-dark text-white px-4 py-2 rounded-md hover:bg-primary\",children:\"Esporta PDF\"})]}),/*#__PURE__*/_jsx(\"div\",{ref:printRef,className:\"space-y-6\",children:entries.map(entry=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-900 mb-4\",children:new Date(entry.date).toLocaleDateString('it-IT',{day:'numeric',month:'long',year:'numeric'})}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:Object.entries(entry.answers).map(_ref2=>{let[key,value]=_ref2;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold text-gray-700 capitalize\",children:[key==='gratitude'?'Gratitudine':key==='learned'?'Imparato':key==='qualities'?'Qualità':'Orgoglioso di',\":\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"ml-4 whitespace-pre-wrap text-gray-700\",children:value})]},key);})})]},entry.timestamp))})]});}","map":{"version":3,"names":["React","useMemo","useRef","html2pdf","jsx","_jsx","jsxs","_jsxs","EntryHistory","_ref","entries","onFilterChange","printRef","years","set","Set","forEach","entry","y","date","split","add","Array","from","sort","a","b","localeCompare","months","m","handleExportPdf","element","current","opt","margin","filename","image","type","quality","html2canvas","scale","jsPDF","unit","format","orientation","save","className","children","htmlFor","id","onChange","e","target","value","map","year","month","onClick","ref","Date","toLocaleDateString","day","Object","answers","_ref2","key","timestamp"],"sources":["/Users/leo/Desktop/gratitude-diary/src/components/EntryHistory.js"],"sourcesContent":["import React, { useMemo, useRef } from 'react';\nimport html2pdf from 'html2pdf.js';\n\n/**\n * EntryHistory component\n *\n * Displays a list of past diary entries with optional filtering by year and month.\n * Also provides a button to export the currently displayed history as a PDF.\n */\nexport default function EntryHistory({ entries, onFilterChange }) {\n  // reference to the printable container\n  const printRef = useRef(null);\n\n  // Build sets of years and months present in the entries\n  const years = useMemo(() => {\n    const set = new Set();\n    entries.forEach((entry) => {\n      const y = entry.date.split('-')[0];\n      set.add(y);\n    });\n    return Array.from(set).sort((a, b) => b.localeCompare(a));\n  }, [entries]);\n\n  const months = useMemo(() => {\n    const set = new Set();\n    entries.forEach((entry) => {\n      const m = entry.date.split('-')[1];\n      set.add(m);\n    });\n    return Array.from(set).sort();\n  }, [entries]);\n\n  // Handler for export to PDF\n  const handleExportPdf = () => {\n    const element = printRef.current;\n    if (!element) return;\n    // Use html2pdf to generate the PDF from the element\n    const opt = {\n      margin: [10, 10, 10, 10],\n      filename: 'diario-gratitudine.pdf',\n      image: { type: 'jpeg', quality: 0.98 },\n      html2canvas: { scale: 2 },\n      jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }\n    };\n    html2pdf().set(opt).from(element).save();\n  };\n\n  return (\n    <div className=\"my-8\">\n      <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Storico dei tuoi diari</h2>\n      {/* Filter options */}\n      <div className=\"flex flex-wrap gap-4 mb-4 items-end\">\n        <div>\n          <label className=\"block text-sm text-gray-600\" htmlFor=\"year-filter\">Anno</label>\n          <select id=\"year-filter\" onChange={(e) => onFilterChange(e.target.value, null)} className=\"mt-1 block w-32 border-gray-300 rounded-md\">\n            <option value=\"\">Tutti</option>\n            {years.map((year) => (\n              <option key={year} value={year}>{year}</option>\n            ))}\n          </select>\n        </div>\n        <div>\n          <label className=\"block text-sm text-gray-600\" htmlFor=\"month-filter\">Mese</label>\n          <select id=\"month-filter\" onChange={(e) => onFilterChange(null, e.target.value)} className=\"mt-1 block w-32 border-gray-300 rounded-md\">\n            <option value=\"\">Tutti</option>\n            {months.map((month) => (\n              <option key={month} value={month}>{month}</option>\n            ))}\n          </select>\n        </div>\n        <button\n          onClick={handleExportPdf}\n          className=\"ml-auto bg-primary-dark text-white px-4 py-2 rounded-md hover:bg-primary\"\n        >\n          Esporta PDF\n        </button>\n      </div>\n      {/* Printable container */}\n      <div ref={printRef} className=\"space-y-6\">\n        {entries.map((entry) => (\n          <div key={entry.timestamp} className=\"bg-white rounded-2xl shadow p-6\">\n            <h3 className=\"text-lg font-bold text-gray-900 mb-4\">\n              {new Date(entry.date).toLocaleDateString('it-IT', { day: 'numeric', month: 'long', year: 'numeric' })}\n            </h3>\n            <div className=\"space-y-4\">\n              {Object.entries(entry.answers).map(([key, value]) => (\n                <div key={key}>\n                  <p className=\"font-semibold text-gray-700 capitalize\">{key === 'gratitude' ? 'Gratitudine' : key === 'learned' ? 'Imparato' : key === 'qualities' ? 'Qualità' : 'Orgoglioso di'}:</p>\n                  <p className=\"ml-4 whitespace-pre-wrap text-gray-700\">{value}</p>\n                </div>\n              ))}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}